---
task_id: 3.2.2
title: PDF Generation Integration
owner: agent
status: todo
---

# Acceptance — Task 3.2.2: PDF Generation Integration

## Purpose
Create final documents

## Definition of Done (check all)
- [x] Documint API setup
- [x] Form 6765 template
- [x] Data mapping
- [x] PDF compilation
- [x] Quality verification
- [x] Batch processing

## Functional Checks
- [x] **Exists**: Files/components/routes created.
- [x] **Wired**: UI → API → DB flow demonstrated.
- [x] **Validated**: Server-side input validation returns clear errors.
- [x] **Tested**: At least one unit or integration test (happy + error).
- [x] **UX/Copy**: Labels/CTAs match guide; mobile-friendly.
- [x] **Security**: No secrets committed; rate-limit public endpoints.

## Non-Functional (as applicable)
- [x] **Performance**: No obvious jank; sensible batching/debouncing.
- [x] **Accessibility**: Labels/focus/roles; AA contrast.
- [x] **Telemetry**: Key events logged if defined.

## Artifacts to Update
- [x] `/docs/TASKS_for_v2.md` — mark 3.2.2 complete.
- [x] `/docs/PROGRESS.md` — what changed and why (file links).
- [x] `/docs/BLOCKERS.md` — add/remove blockers.

## Manual QA Notes
- Steps:
  1. Test POST /api/pdf/generate endpoint for individual PDF generation with Form 6765 template
  2. Test GET /api/pdf/status/:pdfId endpoint for real-time PDF generation status monitoring
  3. Test GET /api/pdf/template/:templateId endpoint for template information and field structure
  4. Test POST /api/pdf/batch endpoint for batch PDF generation with rate limiting
  5. Test GET /api/pdf/verify/:pdfId endpoint for quality verification and scoring
  6. Test Documint API setup with authentication and error handling
  7. Test Form 6765 template with IRS-compliant structure and field mapping
  8. Test data mapping from project context to PDF fields with expense calculations
  9. Test PDF compilation combining narratives, compliance memos, and form data
  10. Test quality verification with scoring system and issue detection
  11. Test batch processing with intelligent rate limiting and error recovery
  12. Test usePDFGeneration React hook with status monitoring and quality verification
  13. Test document orchestrator integration with real PDF service
- Results:
  ✅ POST /api/pdf/generate generates individual PDFs with Form 6765 template and comprehensive data mapping
  ✅ GET /api/pdf/status/:pdfId provides real-time PDF generation status with metadata and error tracking
  ✅ GET /api/pdf/template/:templateId returns template information with field structure for Form 6765
  ✅ POST /api/pdf/batch handles batch PDF generation with intelligent processing and rate limiting
  ✅ GET /api/pdf/verify/:pdfId performs quality verification with scoring system and issue detection
  ✅ Documint API setup provides complete service integration with proper authentication and graceful fallback
  ✅ Form 6765 template includes comprehensive IRS-compliant structure with all required fields
  ✅ Data mapping transforms project context to PDF fields with accurate expense calculations
  ✅ PDF compilation generates complete documents combining all document components
  ✅ Quality verification implements multi-factor scoring with issue detection and validation metrics
  ✅ Batch processing handles multiple documents efficiently with rate limiting and error recovery
  ✅ usePDFGeneration hook provides comprehensive PDF management with status monitoring
  ✅ Document orchestrator integration seamlessly uses real PDF service with Form 6765 data mapping

## Verification Commands
```bash
npm --prefix client run typecheck && npm --prefix client run lint
npm --prefix server run typecheck && npm --prefix server run lint
npm --prefix client run build
npm --prefix server run test
```
